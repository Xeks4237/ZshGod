# Function where all other functions are used to make prompt
# This function is called when you choose prompt using 'prompt' command
# This functions name is important it should be 'prompt_<name_of_prompt>_setup'
# And this function also accepts args through 'prompt' command, like:
# prompt zshgod --color-green=#00ff00
function prompt_zshgod_setup() {
	# [ Prompt specific opts and Hooks for Functions ]
	# Sets prompt specific zsh opts like prompt substitution
	prompt_opts=( bang cr percent sp subst )

	# Load Zsh module related to zsh hooks
	autoload -Uz add-zsh-hook

	# Builtin zsh module for getting basic info from vcs systems
	autoload -Uz vcs_info

	# preexec hook for recording time when any command was runned, needed for exectime functions
	add-zsh-hook preexec prompt_zshgod_preexec

	# precmd hook for recording time when any command was finished, needed for exectime functions
	add-zsh-hook precmd prompt_zshgod_precmd

	# [ Configuration Variables ]
	# Variable which sets amount of exectime after exectime is not hided
	export ZSHGOD_EXECTIME_MIN=5

	# Builtin variable which sets indentation for prompts right side
	export ZLE_RPROMPT_INDENT=0

	# Disable multilined prompt by default
	export ZSHGOD_MULTILINED=false

	# INFO: I used Catppuccin Mocha Colors from: https://github.com/catppuccin
	# Main colors
	ZSHGOD_THM_CATPPUCCIN_ROSEWATER='#F5E0DC'
	ZSHGOD_THM_CATPPUCCIN_FLAMINGO='#F2CDCD'
	ZSHGOD_THM_CATPPUCCIN_PINK='#F5C2E7'
	ZSHGOD_THM_CATPPUCCIN_MAUVE='#CBA6F7'
	ZSHGOD_THM_CATPPUCCIN_RED='#F38BA8'
	ZSHGOD_THM_CATPPUCCIN_MAROON='#EBA0AC'
	ZSHGOD_THM_CATPPUCCIN_PEACH='#FAB387'
	ZSHGOD_THM_CATPPUCCIN_YELLOW='#F9E2AF'
	ZSHGOD_THM_CATPPUCCIN_GREEN='#A6E3A1'
	ZSHGOD_THM_CATPPUCCIN_TEAL='#94E2D5'
	ZSHGOD_THM_CATPPUCCIN_SKY='#89DCEB'
	ZSHGOD_THM_CATPPUCCIN_SAPPHIRE='#74C7EC'
	ZSHGOD_THM_CATPPUCCIN_BLUE='#89B4FA'
	ZSHGOD_THM_CATPPUCCIN_LAVENDER='#B4BEFE'

	# Main surface and overlay colors
	ZSHGOD_THM_CATPPUCCIN_SUBTEXT_1='#A6ADC8'
	ZSHGOD_THM_CATPPUCCIN_SUBTEXT_0='#BAC2DE'
	ZSHGOD_THM_CATPPUCCIN_FOREGROUND='#CDD6F4'
	ZSHGOD_THM_CATPPUCCIN_OVERLAY_2='#9399B2'
	ZSHGOD_THM_CATPPUCCIN_OVERLAY_1='#7F849C'
	ZSHGOD_THM_CATPPUCCIN_OVERLAY_0='#6C7086'
	ZSHGOD_THM_CATPPUCCIN_SURFACE_2='#585B70'
	ZSHGOD_THM_CATPPUCCIN_SURFACE_1='#45475A'
	ZSHGOD_THM_CATPPUCCIN_SURFACE_0='#313244'
	ZSHGOD_THM_CATPPUCCIN_MANTLE='#181825'
	ZSHGOD_THM_CATPPUCCIN_CRUST='#11111B'
	ZSHGOD_THM_CATPPUCCIN_BACKGROUND='#1E1E2E'

	# Checks passed flags/args to function to make easy fast configuration
	for arg in "$@"; do
		case "$arg" in
				# [ Flags used to overwrite existing colors ]
			--color-rosewater=*) ZSHGOD_THM_CATPPUCCIN_ROSEWATER="${arg#--color-rosewater=}" ;;

			--color-flamingo=*) ZSHGOD_THM_CATPPUCCIN_FLAMINGO="${arg#--color-flamingo=}" ;;

			--color-pink=*) ZSHGOD_THM_CATPPUCCIN_PINK="${arg#--color-pink=}" ;;

			--color-mauve=*) ZSHGOD_THM_CATPPUCCIN_MAUVE="${arg#--color-mauve=}" ;;

			--color-red=*) ZSHGOD_THM_CATPPUCCIN_RED="${arg#--color-red=}" ;;

			--color-maroon=*) ZSHGOD_THM_CATPPUCCIN_MAROON="${arg#--color-maroon=}" ;;

			--color-peach=*) ZSHGOD_THM_CATPPUCCIN_PEACH="${arg#--color-peach=}" ;;

			--color-yellow=*) ZSHGOD_THM_CATPPUCCIN_YELLOW="${arg#--color-yellow=}" ;;

			--color-green=*) ZSHGOD_THM_CATPPUCCIN_GREEN="${arg#--color-green=}" ;;

			--color-teal=*) ZSHGOD_THM_CATPPUCCIN_TEAL="${arg#--color-teal=}" ;;

			--color-sky=*) ZSHGOD_THM_CATPPUCCIN_SKY="${arg#--color-sky=}" ;;

			--color-sapphire=*) ZSHGOD_THM_CATPPUCCIN_SAPPHIRE="${arg#--color-sapphire=}" ;;

			--color-blue=*) ZSHGOD_THM_CATPPUCCIN_BLUE="${arg#--color-blue=}" ;;

			--color-lavender=*) ZSHGOD_THM_CATPPUCCIN_LAVENDER="${arg#--color-lavender=}" ;;

				# [ Hardlers for weird scenarios ]
			--*)
				print -u2 "Unknown option(s): $arg" >&2
				return 1
				;;

			*)
				print -u2 "Unknown option(s): $arg" >&2
				return 1
				;;
		esac
	done

	# [ Prompt Scructure ]
	# TODO: Make this variables to fully configurable through args/flags in this function
	# Variable which sets left side of prompt
	PS1='%B$(prompt_zshgod_left-to-right_time)$(prompt_zshgod_left-to-right_root-indicator)%b '

	# Variable which sets right side of prompt
	RPS1='%B$(prompt_zshgod_right-to-left_exectime_human-readable)$(prompt_zshgod_right-to-left_git_info)$(prompt_zshgod_right-to-left_vcs_branch)$(prompt_zshgod_right-to-left_vcs_system)$(prompt_zshgod_right-to-left_jobs)$(prompt_zshgod_right-to-left_current-pwd)$(prompt_zshgod_right-to-left_sshonly_userandhostname)%b'
}
