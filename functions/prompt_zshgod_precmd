# Function which gets called after running command finishes and before prompt is drown
# This function gets unset automatically when you change to another prompt/theme
function prompt_zshgod_precmd() {
	# Cycle through and run all functions in
	# $ZSHGOD_USED_FUNCTIONS array asynchronously
	for async_work in "${ZSHGOD_USED_FUNCTIONS[@]}"; do
		# Start new async worker
		async_start_worker zshgod_async_worker -n

		# Register its callback function
		async_register_callback zshgod_async_worker prompt_zshgod_async-callback

		# Run async job
		async_job zshgod_async_worker "$async_work"
	done

	# Snippet used for prompt_zshgod_exectime function
	(( ${+ZSHGOD_EXECTIME_START} )) || unset ZSHGOD_EXECTIME && return
	ZSHGOD_EXECTIME=$(( EPOCHSECONDS - ZSHGOD_EXECTIME_START ))
	unset ZSHGOD_EXECTIME_START

	# Set right and left sides of the prompt using elements of arrays
	# And join them to don't have extra spaces between elements
	PS1="${(j::)ZSHGOD_LEFT_PROMPT}"
	RPS1="${(j::)ZSHGOD_RIGHT_PROMPT}"
}
