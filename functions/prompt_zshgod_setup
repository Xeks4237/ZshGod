# Function where all other functions are used to make prompt
# This function is called when you choose prompt using 'prompt' command
# This functions name is important it should be 'prompt_<name_of_prompt>_setup'
# And this function also accepts args through 'prompt' command, like:
# prompt zshgod --color-green=#00ff00
function prompt_zshgod_setup() {
	# [ Prompt specific opts and Hooks for Functions ]
	# Sets prompt specific zsh opts like prompt substitution
	prompt_opts=( bang cr percent sp subst )

	# Load Zsh module related to zsh hooks
	autoload -Uz add-zsh-hook

	# Builtin zsh module for getting basic info from vcs systems
	autoload -Uz vcs_info

	# Initialize zsh-async library
	async_init

	# preexec hook gets called before you run any command, like when you press enter
	# Needed for stuff like exectime functions and etc
	add-zsh-hook preexec prompt_zshgod_preexec

	# precmd hook gets called when running command finishes and before prompt is drown
	# Needed for stuff like exectime functions and etc
	add-zsh-hook precmd prompt_zshgod_precmd

	# [ Configuration Variables ]
	# Variable which sets amount of exectime after exectime is not hided
	export ZSHGOD_EXECTIME_MIN=5

	# Disable multilined prompt by default
	export ZSHGOD_MULTILINED=false

	# INFO: I used Catppuccin Mocha Colors as default colors
	# https://github.com/catppuccin

	# Main colors
	# ZSHGOD_THEME_CATPPUCCIN_ROSEWATER='#F5E0DC'
	# ZSHGOD_THEME_CATPPUCCIN_FLAMINGO='#F2CDCD'
	# ZSHGOD_THEME_CATPPUCCIN_PINK='#F5C2E7'
	# ZSHGOD_THEME_CATPPUCCIN_MAUVE='#CBA6F7'
	# ZSHGOD_THEME_CATPPUCCIN_RED='#F38BA8'
	# ZSHGOD_THEME_CATPPUCCIN_MAROON='#EBA0AC'
	# ZSHGOD_THEME_CATPPUCCIN_PEACH='#FAB387'
	# ZSHGOD_THEME_CATPPUCCIN_YELLOW='#F9E2AF'
	# ZSHGOD_THEME_CATPPUCCIN_GREEN='#A6E3A1'
	# ZSHGOD_THEME_CATPPUCCIN_TEAL='#94E2D5'
	# ZSHGOD_THEME_CATPPUCCIN_SKY='#89DCEB'
	# ZSHGOD_THEME_CATPPUCCIN_SAPPHIRE='#74C7EC'
	# ZSHGOD_THEME_CATPPUCCIN_BLUE='#89B4FA'
	# ZSHGOD_THEME_CATPPUCCIN_LAVENDER='#B4BEFE'

	# Main surface and overlay colors
	# ZSHGOD_THEME_CATPPUCCIN_SUBTEXT_1='#A6ADC8'
	# ZSHGOD_THEME_CATPPUCCIN_SUBTEXT_0='#BAC2DE'
	# ZSHGOD_THEME_CATPPUCCIN_FOREGROUND='#CDD6F4'
	# ZSHGOD_THEME_CATPPUCCIN_OVERLAY_2='#9399B2'
	# ZSHGOD_THEME_CATPPUCCIN_OVERLAY_1='#7F849C'
	# ZSHGOD_THEME_CATPPUCCIN_OVERLAY_0='#6C7086'
	# ZSHGOD_THEME_CATPPUCCIN_SURFACE_2='#585B70'
	# ZSHGOD_THEME_CATPPUCCIN_SURFACE_1='#45475A'
	# ZSHGOD_THEME_CATPPUCCIN_SURFACE_0='#313244'
	# ZSHGOD_THEME_CATPPUCCIN_MANTLE='#181825'
	# ZSHGOD_THEME_CATPPUCCIN_CRUST='#11111B'
	# ZSHGOD_THEME_CATPPUCCIN_BACKGROUND='#1E1E2E'

	# Checks passed flags/args to function to make easy fast configuration
	for arg in "$@"; do
		case "$arg" in
				# [ Flags to configure prompt ]
				# Flag to specify config file for prompt
			--config-file=*)
				source "${arg#--config-file=}"
				;;

				# Flag to open simple configuration wizard/editor
			configure) prompt_zshgod_configure ;;

				# [ Hardlers for weird scenarios ]
			--*)
				print -u2 "Unknown option(s): $arg" >&2
				return 1
				;;

			*)
				print -u2 "Unknown option(s): $arg" >&2
				return 1
				;;
		esac
	done

	# [ Prompt Scructure ]
	# Tmp multiline prompt, layout
	# TODO: Make this variables to fully configurable through args/flags in this function
	# Variable which sets left side of prompt
	PS1='%B'
	PS1+='$(prompt_zshgod_left-to-right_current-pwd "#89B4FA" "#11111B")'
	PS1+='$(prompt_zshgod_left-to-right_jobs "#CBA6F7" "#11111B")'
	PS1+='$(prompt_zshgod_left-to-right_vcs_system "#B4BEFE" "#11111B")'
	PS1+='$(prompt_zshgod_left-to-right_vcs_branch "#A6E3A1" "#11111B")'
	PS1+='$(prompt_zshgod_left-to-right_git_info "#6C7086" "#A6E3A1" "#F9E2AF" "#F38BA8" "#89DCEB" "#B4BEFE")'
	PS1+='$(prompt_zshgod_left-to-right_exectime_human-readable "#F9E2AF" "#11111B")'
	PS1+=$'\n'
	PS1+='$(prompt_zshgod_left-to-right_time "#F9E2AF" "#11111B")'
	PS1+='$(prompt_zshgod_left-to-right_root-indicator "#A6E3A1" "#11111B" "#F38BA8" "#11111B")'
	PS1+='%b '

	# Variable which sets right side of prompt
	RPS1='%B'
	RPS1+='$(prompt_zshgod_right-to-left_sshonly_userandhostname "#A6E3A1" "#11111B" "#F38BA8" "#11111B" "#F9E2AF" "#11111B" "#89B4FA" "#11111B")'
	RPS1+='%b'
}
