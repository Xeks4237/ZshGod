# Function which gets called after running command finishes and before prompt is drown
function prompt_zshgod_precmd() {
	# Snippet used for prompt_zshgod_exectime function
	(( ${+ZSHGOD_EXECTIME_START} )) || unset ZSHGOD_EXECTIME && return
	ZSHGOD_EXECTIME=$(( EPOCHSECONDS - ZSHGOD_EXECTIME_START ))
	unset ZSHGOD_EXECTIME_START

	# Stop old async worker
	async_stop_worker zshgod_async_worker

	# Start new async worker
	async_start_worker zshgod_async_worker
	async_register_callback zshgod_async_worker prompt_zshgod_async-callback

	# Cycle through and run all functions in
	# $ZSHGOD_USED_FUNCTIONS array asynchronously
	for async_work in "${ZSHGOD_USED_FUNCTIONS[@]}"; do
		async_job zshgod_async_worker "${async_work}"
	done
}
